Oct 29 2009:

Calculating R2 values.

IDL NPAIRS code (cva_main.pro):
R2 = nCVDims X nPCs (cols X rows)
for each cv dim c,
	cc = CVs for current dim
	regCoeff = regress(pcs, cc, wgt, yf, a0, sig, ft, regCorr, rm, c)
	R2(c, *) = regCorr^2
endfor

where:
pcs = data entered into cva (in pc space) - i.e., pc scores = X
    = nPCDims X nVols (cols X rows)
cc = current dim CV scores = Y = array length nVols
wgt = array of ones (length = no. input data vols) ==> no weighting.
		(NOTE that IDL documentation for regress.pro says that 
		RELATIVE_WEIGHT keyword should be set:
		"If this keyword is set, the input weights (the W vector) are 
		assumed to be relative values, and not based on known uncertainties 
		in the Y vector. Set this keyword in the case of no weighting." But
		there is no RELATIVE_WEIGHT keyword set in npairs code.
yf = RETURNED - contains array length nVols of calculated values of Y (i.e., CV scores)
a0 = RETURNED - constant term
sig = RETURNED - array of standard deviations for returned coeffs
ft = RETURNED - array containing value of F for test of fit
regCorr = RETURNED - array of linear correlation coefficients (R)
rm = RETURNED - variable containing multiple linear correlation coeff.
c = variable containing (reduced, weighted) chi-squared

REGRESS fits function:
y(i) = a0 + a1x(1,i) + a2x(2,i) + ... + a(n)x(n,i)

for each input vol no. i = 1,...,nVols (1-relative since a0 = constant here)
	and n = nPCDims

(Note that npairs IDL code uses obsolete form of regress.pro)

Correlation coefficient is calculated between input arrays X, Y 
(i.e., pc scores (data in pc space) vs cv scores).

---------------------------------

Nov 2 2009:

Save R2 matrix for each CV dim: (no. split halves) rows X (no. PC dims) cols

Testing Matrix.correlate(Matrix M) for Colt libraries vs Matlab corr(A,B): OK!
--------------------------------------------------------------------------
Output of CorrMatTest.java (Colt lib):

A: 
0.9789792720018651 0.3113614146661049 0.3500366934193009 0.7776066777147358 0.4906167952576933 
0.16255681686367973 0.01856720682646773 0.40004304465110074 0.44804144036114746 0.6091867800765177 
0.9449521196964483 0.1411177338243672 0.01636141312064876 0.2866218594382808 0.04641669479275079 
0.2460652497314848 0.7665996209724668 0.7628861275053191 0.6036965238820531 0.10364335428896176 
B: 
0.6137311938618324 0.17519552353928736 0.8418122028939627 
0.9888335081108541 0.21101455613986464 0.5868733178925105 
0.8373563147932682 0.5131573082590649 0.17794239498074615 
0.23664485933263046 0.815922689896014 0.20351726173479123 
Matlib type: Colt
Correlation of A & B: 
0.11672930203239823 -0.2759310874035134 0.19506682013410917 
-0.9933102944442658 0.7671350998109832 -0.33700956570103335 
-0.7297636526000278 0.44023109124890936 -0.015224321319050603 
-0.546572262690061 -0.19565795516640871 0.663220751532963 
0.4764445863041015 -0.8494375088261292 0.8737348621357364
-------------------------------------------------------------
compare Matlab output:


A =

    0.9790    0.3114    0.3500    0.7776    0.4906
    0.1626    0.0186    0.4000    0.4480    0.6092
    0.9450    0.1411    0.0164    0.2866    0.0464
    0.2461    0.7666    0.7629    0.6037    0.1036

>> B = [0.6137311938618324 0.17519552353928736 0.8418122028939627 
0.9888335081108541 0.21101455613986464 0.5868733178925105 
0.8373563147932682 0.5131573082590649 0.17794239498074615 
0.23664485933263046 0.815922689896014 0.20351726173479123]

B =

    0.6137    0.1752    0.8418
    0.9888    0.2110    0.5869
    0.8374    0.5132    0.1779
    0.2366    0.8159    0.2035

>> r = corr(A,B);
>> r

r =

    0.1167   -0.2759    0.1951
   -0.9933    0.7671   -0.3370
   -0.7298    0.4402   -0.0152
   -0.5466   -0.1957    0.6632
    0.4764   -0.8494    0.8737
-------------------------------------------------------------------
Output of CorrMatTest.java (Parallel Colt Double lib):

A: 
0.6645506620407104 0.5060193538665771 0.015881836414337158 0.015634119510650635 0.5357809662818909 
0.4814796447753906 0.5413185358047485 0.3053508996963501 0.6370377540588379 0.8511403799057007 
0.8287712931632996 0.31657689809799194 0.27896690368652344 0.9718291163444519 0.01053708791732788 
0.26800382137298584 0.7855924367904663 0.37148523330688477 0.2773358225822449 0.668375551700592 
B: 
0.91275554895401 0.5712327361106873 0.8396902084350586 
0.8508730530738831 0.6308141946792603 0.5037326812744141 
0.6988415718078613 0.27795201539993286 0.15508735179901123 
0.016252636909484863 0.24220150709152222 0.7508060336112976 
Matlib type: ParallelColt
Correlation of A & B: 
0.7038098573684692 0.090087890625 -0.5901656746864319 
-0.7367653250694275 -0.1450987011194229 0.721362292766571 
-0.656276285648346 -0.5271497964859009 -0.3972652852535248 
0.11897184699773788 -0.2839948832988739 -0.9806370735168457 
-0.10898555815219879 0.5490754246711731 0.6637397408485413 
-------------------------------------------------------------------
compare Matlab output:

>> A = [0.6645506620407104 0.5060193538665771 0.015881836414337158 0.015634119510650635 0.5357809662818909 
0.4814796447753906 0.5413185358047485 0.3053508996963501 0.6370377540588379 0.8511403799057007 
0.8287712931632996 0.31657689809799194 0.27896690368652344 0.9718291163444519 0.01053708791732788 
0.26800382137298584 0.7855924367904663 0.37148523330688477 0.2773358225822449 0.668375551700592 ]

A =

    0.6646    0.5060    0.0159    0.0156    0.5358
    0.4815    0.5413    0.3054    0.6370    0.8511
    0.8288    0.3166    0.2790    0.9718    0.0105
    0.2680    0.7856    0.3715    0.2773    0.6684

>> B = [0.91275554895401 0.5712327361106873 0.8396902084350586 
0.8508730530738831 0.6308141946792603 0.5037326812744141 
0.6988415718078613 0.27795201539993286 0.15508735179901123 
0.016252636909484863 0.24220150709152222 0.7508060336112976 ]

B =

    0.9128    0.5712    0.8397
    0.8509    0.6308    0.5037
    0.6988    0.2780    0.1551
    0.0163    0.2422    0.7508

>> corr(A,B)

ans =

    0.7038    0.0901   -0.5902
   -0.7368   -0.1451    0.7214
   -0.6563   -0.5271   -0.3973
    0.1190   -0.2840   -0.9806
   -0.1090    0.5491    0.6637
---------------------------------------------------------------------
Output of CorrMatTest.java (Parallel Colt Float lib):
A: 
0.9822505116462708 0.6860137581825256 0.2246263027191162 0.6785423755645752 0.24431413412094116 
0.16079682111740112 0.8261550664901733 0.09040248394012451 0.1975964903831482 0.563022792339325 
0.28341972827911377 0.6982226371765137 0.159440815448761 0.4513588547706604 0.6725144982337952 
0.052932798862457275 0.9088631272315979 0.7235851287841797 0.43785303831100464 0.10802322626113892 
B: 
0.40235841274261475 0.2717571258544922 0.06864261627197266 
0.5944689512252808 0.7084795832633972 0.15130072832107544 
0.1962141990661621 0.44222503900527954 0.6202723979949951 
0.8683367371559143 0.8349320292472839 0.8553678393363953 
Matlib type: ParallelColt (Float)
Correlation of A & B: 
-0.4728683829307556 -0.8889284729957581 -0.6641165018081665 
0.9362602233886719 0.9678730368614197 0.5000077486038208 
0.7539047002792358 0.5619696378707886 0.7350132465362549 
-0.29962870478630066 -0.7109897136688232 -0.07823744416236877 
-0.7022069096565247 -0.21377386152744293 -0.20597703754901886 
---------------------------------------------------------------------
compare Matlab output:

>> A = [0.9822505116462708 0.6860137581825256 0.2246263027191162 0.6785423755645752 0.24431413412094116 
0.16079682111740112 0.8261550664901733 0.09040248394012451 0.1975964903831482 0.563022792339325 
0.28341972827911377 0.6982226371765137 0.159440815448761 0.4513588547706604 0.6725144982337952 
0.052932798862457275 0.9088631272315979 0.7235851287841797 0.43785303831100464 0.10802322626113892 ]

A =

    0.9823    0.6860    0.2246    0.6785    0.2443
    0.1608    0.8262    0.0904    0.1976    0.5630
    0.2834    0.6982    0.1594    0.4514    0.6725
    0.0529    0.9089    0.7236    0.4379    0.1080

>> B = [0.40235841274261475 0.2717571258544922 0.06864261627197266 
0.5944689512252808 0.7084795832633972 0.15130072832107544 
0.1962141990661621 0.44222503900527954 0.6202723979949951 
0.8683367371559143 0.8349320292472839 0.8553678393363953]

B =

    0.4024    0.2718    0.0686
    0.5945    0.7085    0.1513
    0.1962    0.4422    0.6203
    0.8683    0.8349    0.8554

>> corr(A,B)

ans =

   -0.4729   -0.8889   -0.6641
    0.9363    0.9679    0.5000
    0.7539    0.5620    0.7350
   -0.2996   -0.7110   -0.0782
   -0.7022   -0.2138   -0.2060
----------------------------------------------------------------------------
Nov 4 2009: 

Comparing IDL and Java R2 output when Y246 test analysis run in each program:

r2 values (ALL analysis): OK!

Need to check split r2 values tomorrow.
----------------------------------------------------------------------------
Nov 5 2009:

r2 values (split analysis): OK!  (IDL vs Java output)

Need to check permutation of CV dims in analysis with more than 1 CV dim.

Ran 5-condition y246 in idl and java.  
r2 values (ALL analysis): OK! (IDL vs Java output)
r2 values (split analyses): OK! (IDL vs Java output)
----------------------------------------
Note that the 5-condition analysis included some permuting of 
CV dims so the r2 values have been successfully permuted.
---------------------------------------

 

